clc
clear
close all

n=-100:100;
w0=0.33*2*pi;
w=0.05*2*pi;

bn=(2*w/pi)*(sin(w*n)./(pi*n)).*cos(w0*n);
bn(101)=w/pi;%Hopital

NoiseBn=awgn(bn,40);
DS_NoiseBn=NoiseBn(1:2:end);

Coef_Filter=[-5.28314437091259e-05,-0.00228983863622678,0.00415496601204029,-1.55126665749000e-18,-0.00602105960956121,0.00483544554379611,0.000164524537800584,0.00207934538532895,-0.00674641209654254,-0.00179325730571808,0.0173633493118839,-0.0153111953217375,-0.00312337750034839,0.00813947292652343,0.00287567598899596,0.00476712701010950,-0.0332922096283142,0.0315376044106861,0.0156287144823543,-0.0438612557552704,0.0166943762843342,-0.00193265939917407,0.0477567425359735,-0.0581809161140468,-0.0650250634442802,0.202959507396785,-0.131210039079736,-0.131087715097407,0.281589325730372,-0.131087715097407,-0.131210039079736,0.202959507396785,-0.0650250634442802,-0.0581809161140468,0.0477567425359735,-0.00193265939917407,0.0166943762843342,-0.0438612557552704,0.0156287144823543,0.0315376044106861,-0.0332922096283142,0.00476712701010950,0.00287567598899596,0.00813947292652343,-0.00312337750034839,-0.0153111953217375,0.0173633493118839,-0.00179325730571808,-0.00674641209654254,0.00207934538532895,0.000164524537800584,0.00483544554379611,-0.00602105960956121,-1.55126665749000e-18,0.00415496601204029,-0.00228983863622678,-5.28314437091259e-05];

Coef_Filter2=[0.000162411235492125,0.00355729806723443,-0.00311893875684266,8.58353706454336e-19,-0.00451972798793100,0.00751193591331289,0.000505771403864582,-0.00137996542519361,-0.00669382686865763,-0.00199446584387669,0.0145748499670944,-0.00406340651682391,0.00218096041782039,-0.0248554627922029,0.0205987512329366,0.00324959089545704,0.0144021676114968,-0.0285386879134216,-0.0155068957287943,0.0287606613450254,0.0111901304239521,0.0257854081217173,-0.0966161610750685,0.0419414272706542,-0.00823209040488874,0.160196934896505,-0.168628407776185,-0.209113661650226,0.478961939013600,-0.209113661650226,-0.168628407776185,0.160196934896505,-0.00823209040488874,0.0419414272706542,-0.0966161610750685,0.0257854081217173,0.0111901304239521,0.0287606613450254,-0.0155068957287943,-0.0285386879134216,0.0144021676114968,0.00324959089545704,0.0205987512329366,-0.0248554627922029,0.00218096041782039,-0.00406340651682391,0.0145748499670944,-0.00199446584387669,-0.00669382686865763,-0.00137996542519361,0.000505771403864582,0.00751193591331289,-0.00451972798793100,8.58353706454336e-19,-0.00311893875684266,0.00355729806723443,0.000162411235492125];

tic
y = filter(Coef_Filter,1,NoiseBn);
toc
DS_NoiseBn=NoiseBn(1:2:end);
tic
y2 = filter(Coef_Filter2,1,DS_NoiseBn);
toc
Hw_F=fft(y);
DS_Hw_F=fft(y2);

f=-1:1/((length(Hw_F)-1)/2):1;
f2=-1:1/((length(DS_NoiseBn)-1)/2):1;


subplot(2,1,1), plot(f,abs(Hw_F))
title('Filterd Signal ')

subplot(2,1,2), plot(f2,abs(DS_Hw_F))
title('filtered Decimated Signal')
